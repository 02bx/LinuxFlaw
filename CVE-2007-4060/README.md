# CVE-2007-4060 & EDB-4243

## Experiment Environment

Debian Jessie

[DockerFile](https://github.com/mudongliang/Dockerfiles/tree/master/CVE-2007-4060)

[Docker Image](https://hub.docker.com/r/mudongliang/cve-2007-4060/)

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2007-4060/corehttp-0.5.3-patched.tar.gz

tar -xvf corehttp-0.5.3-patched.tar.gz;
cd corehttp/src;

make;
```

## Problems in Installation & Configuration

1. Change the absolute path in chttp.conf;
2. Use the patched version of corehttp(remove daemon mode and disable segment fault handler);

## How to trigger vulnerability

```
# nohup /root/corehttp/src/corehttp /root/corehttp/chttp.conf &
# /root/xcorehttp -h 127.0.0.1 -p 5555;
```

## PoCs

[CoreHTTP 0.5.3alpha (httpd) - Remote Buffer Overflow](https://www.exploit-db.com/exploits/4243/)


## Vulnerability Details & Patch

### Root Cause

```
http.c:32

        sscanf(parentsprock->buffer, "%[A-Za-z] %s%*[ \t\n]", req, url);
```

### Stack Trace



## References
