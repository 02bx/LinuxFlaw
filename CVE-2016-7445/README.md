# CVE-2016-7445

## Experiment Environment
Ubuntu 14.04 LTS

## INSTALL & Configuration
```
wget https://github.com/uclouvain/openjpeg/archive/v2.1.1.tar.gz
tar xvf v2.1.1.tar.gz
cd openjpeg-2.1.1
mkdir build
cd build
cmake ..
make
```

## Problems in Installation & Configuration
```
could not find TIFF
```
```
sudo apt-get install libtiff5-dev
```

```
could not find LCMS2
```
```
sudo apt-get install liblcms2-dev
```


```
convertpng.c: undefined reference to `png_jmpbuf'
...
convertpng.c: undefined reference to `png_get_bit_depth'
```
```
wget ftp://ftp-osl.osuosl.org/pub/libpng/src/libpng16/libpng-1.6.32.tar.gz
tar xvf libpng-1.6.32.tar.gz
cd lipng-1.6.32.tar.gz
./configure
make
sudo make install
```
If you try to install libpng directly through apt-get, the \*.so and \*.a file will not be installed in /usr/local/lib.


## How to trigger vulnerability
```
./bin/opj_compress -i openjpeg-nullptr-github-issue-842.ppm -o out.j2k
```

## PoCs
[openjpeg-issue-843](https://github.com/uclouvain/openjpeg/issues/843)

## Vulnerability Details & Patch

### Root Cause
jp2/convert.c:1483

jp2/convert.c:1485

### Stack Trace

## References
