# CVE-2008-5314

## Experiment Environment

Ubuntu 14.04.3 LTS

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2008-5314/clamav-0.93.3.tar.gz
cd clamav-0.93.3/
mkdir build
./configure --prefix ${PWD}/build
make
make install
```

**Note:** when you just `make` to compile clamav, you will get one clamscan in the fold `clamscan`, but it is one script. The easiest method to find the executable binary is `make install`. However, we don't want to install this software in the default directory `/usr/local/`. Just use `--prefix ` to specify its installation directory.

## Problems in Installation & Configuration

**1. configure: error: User clamav (and/or group clamav) doesn't exist. Please read the documentation !**

**Solution:**

```
$ sudo adduser clamav
```

## How to trigger vulnerability

```
$ gcc -o exploit 7330.c
$ ./exploit
done, now run clamscan on ./clamav-jpeg-crash.jpg
$ mv clamav-jpeg-crash.jpg build/bin/
$ cd build/bin/
$ ./clamscan clamav-jpeg-crash.jpg 
```

## PoCs

[ClamAV < 0.94.2 - JPEG Parsing Recursive Stack Overflow (PoC)](https://www.exploit-db.com/exploits/7330/)

## Vulnerability Patch
  
## References
