# CVE-2004-1292

## Experiment Environment

Ubuntu 11.04

## INSTALL & Configuration

```
wget https://github.com/mudongliang/source-packages/raw/master/CVE-2004-1292/ringtonetools-2.22.tar.gz
tar -xvf ringtonetools-2.22.tar.gz
cd ringtonetools-2.22
make
```

## Problems in Installation & Configuration

## How to trigger vulnerability

```
./ringtonetools 31.emelody
```

## PoCs

[Ringtone Tools Buffer Overflow in parse_emelody() Lets Remote Users Execute Arbitrary Code](https://securitytracker.com/id/1012573)

[Michael Kohn Ringtone Tools EMelody File Remote Buffer Overflow Vulnerability](https://www.securityfocus.com/bid/12010/exploit)

[Michael Kohn Ringtone Tools 2.22 - '.EMelody' File Remote Buffer Overflow](https://www.exploit-db.com/exploits/25015/)

## Vulnerability Patch

### Root Cause

> In parse_emelody.c, parse_emelody() reads any amount of
> input into a 1024-byte song[] array.

### Stack Trace

## References
